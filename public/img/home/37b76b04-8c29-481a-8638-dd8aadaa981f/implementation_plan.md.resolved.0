# Implementation Plan - OPE-502 Announcement System

This plan outlines the steps to implement the Announcement System (OPE-502) in the Game Operations backend.

## Proposed Changes

### [Component Name] API & Types

#### [NEW] [announcement.ts](file:///c:/Users/Administrator/Desktop/營運後台/src/types/announcement.ts)
- Define `AnnouncementType` (Marquee, SystemNotification, OperationAnnouncement).
- Define `Announcement` interface with fields: id, type, title, languages, content, jumpUrl, startTime, endTime, weight, status (test/live), lastModifiedAt, lastModifiedBy.

#### [NEW] [announcement.ts](file:///c:/Users/Administrator/Desktop/營運後台/src/api/announcement.ts)
- Implement CRUD operations for announcements.
- `getAnnouncements(params: QueryParams)`
- `createAnnouncement(data: CreateData)`
- `updateAnnouncement(id: string, data: UpdateData)`
- `deleteAnnouncement(id: string)`
- `toggleStatus(id: string, site: 'test' | 'live', status: boolean)`

### [Component Name] Frontend Views

#### [NEW] [Announcement.vue](file:///c:/Users/Administrator/Desktop/營運後台/src/views/Master/Announcement.vue)
- Main page for announcement management.
- Features:
    - Search Bar: Type, Title, Languages, Time range.
    - Data Table: List display with weight input and status switches.
    - Action Buttons: Add, Edit, Delete.
    - Form Modal: For creating and editing announcements.

### [Component Name] Routing

#### [MODIFY] [index.ts](file:///c:/Users/Administrator/Desktop/營運後台/src/router/index.ts)
- Add `/admin/announcements` route.

#### [MODIFY] [Layout.vue](file:///c:/Users/Administrator/Desktop/營運後台/src/views/Master/Layout.vue)
- Add "公告系統" to the "前台設定" menu.

## Verification Plan

### Automated Tests
- Verification of sorting logic (weight > start time).
- Verification of language filtering.

### Manual Verification
- **AC 1: Scheduling**: Create an announcement with a future start time and verify it's not active yet.
- **AC 2: Multi-language**: Toggle between languages to see if the correct announcements appear.
- **AC 3: Sorting**: Check if records with lower weight appear first.
- **AC 4: Security**: Test XSS by inserting `<script>` into content.
- **AC 5: Status Toggle**: Toggle status and verify the API call is made and UI updates.
