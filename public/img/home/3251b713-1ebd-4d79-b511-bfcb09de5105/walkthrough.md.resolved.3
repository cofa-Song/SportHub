# OPE-201 玩家管理模組 - 驗證指南

本指南旨在協助驗證 OPE-201 玩家管理列表與詳情功能的正確性。

## 1. 驗證環境
- 啟動開發伺服器: `npm run dev` in `營運後台` folder.
- 登入帳號: `dev_admin` / `dev123456`
- 進入路由: `/admin/players` (或點擊側邊欄「玩家管理」)

## 2. 驗收標準 (Acceptance Criteria) 覆蓋

### [x] AC 1：註冊來源追蹤驗證
- **測試步驟**: 查看玩家列表或詳情頁中的「註冊來源」。
- **預期結果**: 應顯示 `Admin_Manual` (後台新增) 或 `SEO_Google` (Mock 數據)。

### [x] AC 2：測試帳號數據隔離
- **測試步驟**: 在列表頁使用「新增玩家」，標籤預設鎖定為 `TEST`。
- **預期結果**: 新增成功後，該帳號帶有黃色 `TEST` 標籤。

### [x] AC 3：流水轉化準確性 (模擬)
- **測試步驟**: 在詳情頁「錢包監控」查看「流水活動錢包」餘額。
- **預期結果**: 點擊「放棄當前獎勵」後，該餘額應歸零，且觸發異動紀錄。

### [x] AC 4：編輯紀錄完整性
- **測試步驟**: 修改玩家資料或帳戶狀態 (如: 正常 -> 鎖定)。
- **預期結果**: 
    1. 系統彈出強制填寫原因視窗。
    2. 操作後，在「異動紀錄」Tab 中可見最新的一筆操作紀錄，包含操作人、原因與變更值。

### [x] AC 5：錢包數據顯示
- **測試步驟**: 查看詳情頁的「錢包監控」Tab。
- **預期結果**: 應正確區分四種錢包 (儲值金幣、保險箱、通用銀幣、活動銀幣) 的餘額。

## 3. 功能展示

### 玩家列表 (Player List)
- 支援 ID/帳號搜尋
- 狀態/標籤篩選
- 分頁功能

### 玩家詳情 (Player Detail)
- **基本資料**: 顯示註冊資訊與 VIP 等級。
- **狀態管理**: 支援一鍵鎖定/凍結，並可勾選「強制踢線」。
- **錢包監控**: 視覺化展示各錢包餘額。
- **異動日誌**: 完整留痕所有敏感操作。

## OPE-202 核心帳務引擎 - 驗證指南

本模組透過「模擬引擎」與「開發者工具」來驗證複雜的流水邏輯。

### [ ] AC 1：流水累計驗證
- **前置**: 找一位有「流水活動錢包」且狀態為 ACTIVE 的玩家 (Mock 資料中每 5 位玩家有一位，如 `P10000`, `P10005`)。
- **測試步驟**:
    1. 在詳情頁「流水活動錢包」區塊，點擊「模擬投注 (10)」。
    2. 觀察「流水監控」進度條是否增加 10。
    3. 觀察「當前餘額」是否減少 10。
- **預期結果**: 進度與餘額同步變更。

### [ ] AC 2：達標轉換驗證
- **前置**: 挑選一個剩餘流水較低的玩家，或多次點擊「模擬投注」直到 `Current >= Target`。
- **測試步驟**:
    1. 繼續投注直到達標。
    2. 觀察介面變化。
- **預期結果**:
    1. 活動錢包歸零。
    2. 儲值錢包 (Cash) 餘額增加 (增加金額為 [min(活動餘額, Cap)](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/types/index.ts#47-63))。
    3. 容器狀態重置，若 Queue 中有卡片，會自動載入下一張。

### [ ] AC 3：放棄獎勵驗證
- **測試步驟**: 點擊「放棄獎勵」按鈕並確認。
- **預期結果**: 活動錢包歸零，容器重置。

### [ ] AC 4：破產機制驗證
- **測試步驟**: 持續投注直到銀幣餘額 < 1。
- **預期結果**: 觸發破產保護，容器自動重置。

## OPE-203 資產與流水變動日誌 - 驗證指南

本模組提供完整的資金異動審計。請至 `/admin/asset-logs` 查看日誌。

### [ ] AC 1：幣別隔離流水驗證
- **測試步驟**:
    1. 在玩家詳情頁，先點擊「模擬投注 (10)」。(這是銀幣，有效流水應為 10)
    2. 到「資金日誌」頁面查詢該玩家。
    3. 確認有一筆 `BET` 紀錄，幣別 `SILVER`，有效流水 `10`。
    4. 回到詳情頁，假設我們有金幣投注功能(或透過 P2P 消耗金幣)，此處以「金幣兌換」模擬金幣消耗。
    5. 執行金幣相關操作 (如 P2P 轉出)。
    6. 確認日誌中金幣操作的 `Valid Turnover` 為 `0` 或 `-`。

### [ ] AC 2：金銀互換軌跡驗證
- **測試步驟**:
    1. 在詳情頁點擊「金轉銀 (1)」。
    2. 查看日誌，應出現兩筆 `EXCHANGE` 紀錄：
        *   `CASH` (Gold): Amount `-1`
        *   `BONUS` (Silver): Amount `+100`

### [ ] AC 3：活動解鎖清零驗證
- **測試步驟**:
    1. 完成活動解鎖 (參考 OPE-202 AC2)。
    2. 查看日誌，應依序出現：
        *   `UNLOCK` (Bonus): 扣除餘額
        *   `UNLOCK` (Cash): 增加餘額
        *   `WIPE` (Bonus): 若有溢出，紀錄清零

### [ ] AC 4：P2P 轉帳紀錄驗證
- **測試步驟**:
    1. 在詳情頁點擊「P2P 轉出 (100)」。
    2. 查看日誌，應出現：
        *   `P2P_OUT`: Amount `-108` (含手續費)，關聯單號為接收者 ID。
    3. 搜尋接收者 ID (模擬器會提示轉給誰，如 `P100xx`)。
    4. 查看接收者日誌，應出現：
        *   `P2P_IN`: Amount `+100`，關聯單號為發送者 ID。

## OPE-204 遊戲對局紀錄 - 驗證指南

本模組為第三方遊戲對接的核心稽核介面。請至 `/admin/merchants` (需確認路由) 或側邊欄點選「遊戲對局紀錄」(如果有的話，目前尚未加入側邊欄，稍後我會補上)。 
**更正**: 目前尚未加入側邊欄。請手動輸入路由 `/admin/game-logs` 或等待我補上。
(等等，我先補上側邊欄路由再寫驗證)

Wait, I should check if I added the route. I see [GameLogs.vue](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/views/Master/GameLogs.vue) exists but I didn't check [router/index.ts](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/router/index.ts) for OPE-204 specifically setup. 
Wait, [GameLogs.vue](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/views/Master/GameLogs.vue) was already there and likely routed. Let me check [router/index.ts](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/router/index.ts). 
Ah, looking at file history [router/index.ts](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/router/index.ts)... I don't see `game-logs` explicitly. 
Wait, [GameLogs.vue](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/views/Master/GameLogs.vue) might be unused or under a different name?
Let me check [src/router/index.ts](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/router/index.ts) again content.
Step 300 showed [GameLogs.vue](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/views/Master/GameLogs.vue) content, but I didn't check router recently for Game Logs entry. 
Actually [src/views/Master/GameLogs.vue](file:///c:/Users/Administrator/Desktop/%E7%87%9F%E9%81%8B%E5%BE%8C%E5%8F%B0/src/views/Master/GameLogs.vue) exists. 
Let me quickly add the route and menu item before finalizing walkthrough.

I will pause updating walkthrough and fix the route first.
